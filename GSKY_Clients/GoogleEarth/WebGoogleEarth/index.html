<!DOCTYPE html>
<html lang="en">
<head>
<title>GSKY via Google Earth</title>
    <!--NOTE: Most Web WorldWind examples use jquery, Bootstrap and requirejs but those technologies are NOT-->
    <!--required by Web WorldWind. See SimplestExample.html for an example of using Web WorldWind without them.-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>-->
<!--    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>-->
<!--    <script data-main="geoglam" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.17/require.min.js"></script>-->
    <link rel="stylesheet" href="custom.css"> <!-- AVS: Added to change the styles of buttons -->
	<script type="text/javascript">
	function InsertTimes(item)
	{
		var i = item.selectedIndex;
		var times = "times_"+i;
		showHide(times,'block');
	}
	function showHide(id,type,state)
	{
		if (state == undefined) state = 'block';
		if(id)
		{
			var style = document.getElementById(id).style.display;
			document.getElementById(id).style.display=""+state;
		}
	}
	function Fin()
	{
		showHide('avs_waiting_circle','span','none');
	}
	function GetCoordinates(form,item)
	{
		var region = [];
		region["Aus_ALL"] = "112.324219,-44.087585,153.984375,-10.919618";
		region["WA"] = "113.378906,-35.137879,129.067383,-13.539201";
		region["NT"] = "128.979492,-26.076521,137.988281,-11.005904";
		region["SA"] = "129.023438,-37.996163,141.064453,-25.958045";
		region["QLD"] = "138.032227,-28.998532,154.467773,-10.919618";
		region["NSW"] = "140.888672,-38.891033,154.160156,-27.994401";
		region["ACT"] = "148.699951,-35.942436,149.479980,-35.119909";
		region["VIC"] = "140.756836,-38.925229,151.435547,-34.415973";
		region["TAS"] = "143.525391,-43.644026,148.623047,-39.504041";
		region["NZ"] = "166.333008,-47.368594,178.989258,-34.198173";
		region["US_ALL"] = "-125.859375,25.165173,-60.468750,48.458352";
		region["US_WC"] = "-124.628906,31.802893,-110.039063,48.806863";
		region["US_CEN"] = "-109.160156,26.902477,-95.097656,48.922499";
		region["US_EAST"] = "-94.746094,25.482951,-62.753906,47.517201";
		region["West_Europe"] = "-11.250000,35.889050,18.808594,58.722599";
		region["Eest_Europe"] = "19.511719,37.020098,40.429688,59.445075";
		var bbox = region[item.value];
		if (bbox)
		{
			coords = bbox.split(",");
			form.west.value = coords[0];
			form.south.value = coords[1];
			form.east.value = coords[2];
			form.north.value = coords[3];
		}
//alert(coords[0]);		
	}
	</script>
</head>
<body>
<div class="container">
    <table class="jumbotron hidden-xs" style="width:100%">
		<tr>
			<td style="width:20%">
				<img src="https://nci.org.au/wp-content/uploads/2018/09/NCI-Australia-and-Text-website-2-2.png" style="width:300px">
			</td>
			<td style="text-align:right">
				<img src="https://gsky.nci.org.au/img/logo.svg" width="150">
			</td>
			<td nowrap>
				<h2>GSKY Web Map Service</h2><br><h6>Powered by: Google Earth</h6>
			</td>
		</tr>
    </table>
    <div>
    <hr>
    <table style="width:100%; font-size:16px">
		<tr>
		<td>
    <small>
<p>
		<h2>INTRODUCTION</h2>
        This is a wrapper to work with <b>Google Earth Web</b> (<b>GEWeb</b>) to display GSKY layers.
        It creates the required <b>KML</b> files (Keyhole Markup Language) that can be opened in both.
        The purpose is to extend the functionality of these programs to display GSKY layers in both spatial and temporal dimensions.
        
        <br><br> 
        <b>Notes:</b><br>
        <ul>
        <li>
        GEWeb  currently works only in Google Chrome.
        </li>
        <li>
        The selectable geographical regions available are limited to Australa, NZ, USA and Europe. We may add more regions in the future. 
        You can manually specify the Lat/Lon coordinates of any region.
        </li>
        <li>
        Scroll down to see details about the program and its usage.
        </li>
        <li>
        Or, <b>dig right in below!</b>
        </li>
        </ul>
        <hr>
        <h3>TL;DR</h3>
        <ol>
        <li>
        	Choose the required GSKY layer.
        </li>
        <li>
        	Choose the geographical region. 
        	<ul>
        	<li>
        		If the required region is not listed, choose '<b>Unlisted</b>' and manually enter its coordinates.
        	</li>
				<ul>
				<li>
					Use <a href="http://epsg.io/map#srs=4326&x=46.406250&y=11.695273&z=3&layer=streets" target="_blank"><b>this site</b></a> to get its coordinates.
				</li>
				</ul>
        	</ul>
        </li>
        <li>
        	Choose the date to show. Default is the latest date.
        </li>
        <li>
        	Click '<b>Create KML</b>' and click again on the link that appears.
        </li>
        <li>
        	Save the <b>*.kml</b> file on your computer and open it with GE or GEW.
        </li>
        </ol>
        
</p> 
<p>
	<div align="center" style="text-align:left; width:90%">
	<form id="google_earth" name="google_earth">
    <table class="jumbotron hidden-xs" style="width:100%">
		<tr>
			<td style="width:20%; text-align:right; font-weight:bold; padding-right:10px">
				GSKY Layer
			</td>
			<td style="width:80%; padding-top:0px">
				<select name="layer" style="width:300px;" onchange="InsertTimes(this)">
					<option value="">Choose Below</option>
					<option value="global:c6:frac_cover|GEOGLAM Fractional Cover C6">GEOGLAM Fractional Cover C6</option>
					<option value="global:c6:total_cover|GEOGLAM Total Cover C6">GEOGLAM Total Cover C6</option>
					<option value="global:c6:monthly_frac_cover|GEOGLAM Monthly Fractional Cover C6">GEOGLAM Monthly Fractional Cover C6</option>
					<option value="global:c6:monthly_total_cover|GEOGLAM Monthly Total Cover C6">GEOGLAM Monthly Total Cover C6</option>
					<option value="global:c6:monthly_decile_total_cover|GEOGLAM Monthly Decile Total Cover C6">GEOGLAM Monthly Decile Total Cover C6</option>
					<option value="global:c6:monthly_anom_frac_cover|GEOGLAM Anomaly Fractional Cover C6">GEOGLAM Anomaly Fractional Cover C6</option>
					<option value="LS8:NBAR:TRUE|DEA Landsat 8 surface reflectance">DEA Landsat 8 surface reflectance true colour</option>
				</select>
			</td>
		</tr>
		<tr>
			<td style="width:20%; text-align:right; font-weight:bold; padding-right:10px">
				Region
			</td>
			<td style="width:80%; padding-top:10px">
				<select name="region" style="width:300px;" onchange="GetCoordinates(this.form,this)">
					<option value="">Choose Below</option>
					<option value="Aus_ALL">Australia</option>
					<option value="WA"> Western Australia</option>
					<option value="NT">Northern Territory</option>
					<option value="SA">South Australia</option>
					<option value="QLD">Queensland</option>
					<option value="NSW">NSW</option>
					<option value="ACT">ACT</option>
					<option value="VIC">Victoria</option>
					<option value="TAS">Tasmania</option>
					<option value="">---------------------------</option>
					<option value="NZ">New Zealand</option>
					<option value="">---------------------------</option>
					<option value="US_ALL">USA</option>
					<option value="US_WC">USA West Coast</option>
					<option value="US_CEN">USA Central</option>
					<option value="US_EAST">USA East Coast</option>
					<option value="">---------------------------</option>
					<option value="West_Europe">Western Europe</option>
					<option value="Eest_Europe">Western Europe</option>
					<option value="">---------------------------</option>
					<option value="UNLISTED">Unlisted Region</option>
				</select>
			</td>
		</tr>
		<tr>
			<td style="width:20%; text-align:right; font-weight:bold; padding-right:10px">
				Co-ordinates
			</td>
			<td style="width:80%; padding-top:10px">
				<small>W: <input type="text" name="west" value="" style="width:100px"></small>
				<small>S: <input type="text" name="south" value="" style="width:100px"></small>
				<small>E: <input type="text" name="east" value="" style="width:100px"></small>
				<small>N: <input type="text" name="north" value="" style="width:100px"></small>
			</td>
		</tr>
		<tr>
			<td style="width:20%; text-align:right; font-weight:bold; padding-right:10px">
				Time
			</td>
			<td style="width:80%; padding-top:10px">
				<span id="times" style="display:none"></span>
			</td>
		</tr>
		<tr>
			<td style="width:100%; text-align:left; font-weight:bold; padding-right:10px" colspan="2">
				<input type="button" value="Create KML" onclick="showHide('kml','none'); ajaxFunction(1,document.forms.google_earth)">
				<span id="kml" style="display: none">KML</span>
			</td>
		</tr>
	</table>
	</form>
	</div>
</p>	
<p><hr>
		<h2>Details</h2>
		Many GIS clients such as <b>TerriaMap, ArcGIS, QGIS, NASA WorldWind</b> and <b>Google Earth Desktop (GE)</b> support the WMS services.
		They request the Capability statement via a GSKY server URL. Thereafter the "GetMap" requests are sent
		based on the visible Lat/Lon coordinates on the screen. 
		<br>
		<br>
		The GEWeb does not have a WMS support as above. However, it can send the GetMap requests
		via a KML file and get the GSKY layers. 
		<br>
		<br>
		While GE works almost similar to TerriaMap, it lacks the ability to display time layers as in TerriaMap.
		Only the latest time layer is displayed. When using their WMS service there is no way to specify a time layer as e.g. <i>TIME=2001-01-01T00:00:00.000Z</i>.
		The only way to do so requires to use a manually created/edited KML file. It is time consuming and error prone, even if one knows
		the KML syntax.
		
		<br>
		<br>
		Here we provide a way to create functional KML files where the time and Lat/Lon coordinates are coded
		via web-based controls. Such KML files can be opened in either GE or GEW.
		
		<h2>Usage</h2>
		<OL>
		<li>
		Have a GEWeb page opened alongside this page.
		</li>
		<br>
		<li>
		Create a KML file using the dropdown lists and inputs above and save locally or on your Google Drive.		
		</li>
		<br>
		<li>
		For GE, double click on the file. For GEW, open the file via the "<b>IMPORT KML File</b>" link.		
		</li>
		<br>
		<li>
		<b>That is it!</b><br>You will see a GSKY layer for each KML file imported. The layers will stay permanently and hence
		you do not have to recreate the files every time. 
		<br>
		<br>
		You will, however, need to create a new KML file to see another time layer or
		another bounding box. Unlike in the WMS service, you cannot simply pan to a different part of the globe and get the layers
		re-displayed as you move. 
		<br>
		<br>
		You can zoom in/out, and the GSKY layers will get smaller/bigger but their resolution will not change. To see a smaller region,
		select from the "Region" dropdown.
		</li>

		</ol>
</p>        
        
        
    </small>
		</td>
		</tr>
    </table>
<small><small>
<hr>
Copyright &copy; 2019, National Computational Infrastructure (<a href="http://nci.org.au/">NCI</a>), Canberra, ACT 2601, Australia.
<br>
Author: Dr. Arapaut V. Sivaprasad. Created on: 31 March, 2019.
</small></small>
<hr>
    </div>
</div>
<script src="ajax.js"></script>
<script src="times.js"></script>
</script>
</body>
</html>